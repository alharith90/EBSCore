@using EBSCore.Web.Models.BIA
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.Extensions.Localization
@inject HttpClient Http
@inject IStringLocalizer<BCM.BIA> Localizer

<EditForm Model="Model" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />
    <div class="row">
        <div class="col-md-6">
            <label class="form-label">@Localizer["BIACode"]</label>
            <input class="form-control" @bind-value="Model.BIACode" @bind-value:event="oninput" />
        </div>
        <div class="col-md-6">
            <label class="form-label">@Localizer["ProcessName"]</label>
            <input class="form-control" @bind-value="Model.ProcessName" @bind-value:event="oninput" />
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-3">
            <label class="form-label">RTO</label>
            <input class="form-control" @bind-value="Model.RTO" @bind-value:event="oninput" />
        </div>
        <div class="col-md-3">
            <label class="form-label">RPO</label>
            <input class="form-control" @bind-value="Model.RPO" @bind-value:event="oninput" />
        </div>
        <div class="col-md-3">
            <label class="form-label">MTPD</label>
            <input class="form-control" @bind-value="Model.MTPD" @bind-value:event="oninput" />
        </div>
        <div class="col-md-3">
            <label class="form-label">MBCO</label>
            <input class="form-control" @bind-value="Model.MBCO" @bind-value:event="oninput" />
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-6">
            <label class="form-label">@Localizer["Criticality"]</label>
            <input class="form-control" @bind-value="Model.Criticality" @bind-value:event="oninput" />
        </div>
        <div class="col-md-6">
            <label class="form-label">@Localizer["RequiredCompetencies"]</label>
            <input class="form-control" @bind-value="Model.RequiredCompetencies" @bind-value:event="oninput" />
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-6">
            <label class="form-label">@Localizer["AlternativeWorkLocation"]</label>
            <input class="form-control" @bind-value="Model.AlternativeWorkLocation" @bind-value:event="oninput" />
        </div>
        <div class="col-md-6">
            <label class="form-label">@Localizer["RegulatoryRequirements"]</label>
            <input class="form-control" @bind-value="Model.RegulatoryRequirements" @bind-value:event="oninput" />
        </div>
    </div>
    <button class="btn btn-primary mt-3" type="submit">@Localizer["Save"]</button>
</EditForm>

@code {
    [Parameter] public EventCallback OnSaved { get; set; }
    [Parameter] public S7SBIA Model { get; set; } = new();

    private async Task HandleValidSubmit()
    {
        await Http.PostAsJsonAsync("api/S7SBIA/Save", Model);
        if (OnSaved.HasDelegate)
        {
            await OnSaved.InvokeAsync();
        }
    }
}
