@page "/Documents/Communications"
@using EBSCore.Web.Models
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.Extensions.Localization
@using Microsoft.JSInterop
@using Newtonsoft.Json
@using EBSCore.Web.Services
@using Microsoft.AspNetCore.Components.Web
@using System.Net.Http.Json
@using System.Linq
@using EBSCore.Web.Pages.Controls

@inject IJSRuntime JS
@inject HttpClient Http
@inject NavigationManager Navigation
@inject IStringLocalizerFactory LocalizerFactory
@inject PageTitleService PageTitleService

<h3>@Localizer["CommunicationLogsTitle"]</h3>
<p>@Localizer["CommunicationLogsDescription"]</p>

<button class="btn btn-secondary" @onclick="QueueNotifications">@Localizer["QueueNotifications"]</button>

@code {
    private IStringLocalizer Localizer;

    protected override void OnInitialized()
    {
        Localizer ??= LocalizerFactory.Create(typeof(App));
    }

    private async Task QueueNotifications()
    {
        try
        {
            await Http.PostAsync("/api/S7SDocControl/notifications/review", null);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Failed to queue notifications: {ex.Message}");
        }
    }
}
